# 产品说明书：ImagePro (图片大师)

## 概述
ImagePro 是一款专注于隐私和速度的客户端 Web 图片处理应用。它允许用户直接在浏览器中上传、编辑和导出图片，无需服务器端处理。

## 核心功能
1.  **图片上传**：支持拖拽或文件选择。**全屏拖拽支持**：支持将图片拖拽至页面任意区域进行上传，拖拽时左侧上传控件会有高亮提示。支持常见格式（PNG, JPG, WebP）。
2.  **裁剪 (Crop)**：
    -   支持比例：19:6, 16:9, 16:10, 1:1, 4:3, 3:4, 9:16, 10:16 以及 自由/原始比例。
    -   **高级交互 (Advanced Interaction)**：
        -   **旋转 (Rotation)**：在裁剪框外部拖拽可任意角度旋转图片。旋转时显示**9x9 精细网格**辅助对齐，鼠标光标变为刷新样式 (Refresh Icon)。
        -   **平移 (Pan)**：在裁剪框内部拖拽可移动图片。
        -   **居中缩放**：拖拽角点（Corner）时以中心为基准调整大小。
    -   **无损导出**：裁剪过程始终基于**原始图像分辨率**计算，确保导出图片保持最高画质，不受屏幕显示尺寸限制。
    -   **持久化**：记忆选择的宽高比。
    -   **重置 (Reset)**：提供重置按钮，恢复原始画布尺寸、原始宽高比及全图显示。
    -   **UI 优化**：支持 ESC 退出，Cancel 按钮取消。"Start Crop" 按钮增加裁剪图标。只有在裁剪模式下才显示比例选项，非裁剪模式折叠格式/尺寸设置。
3.  **调整大小 (Resize)**：
    -   **画布尺寸**：精确控制宽、高数值。
    -   **宽高比锁定**：支持锁定长宽比（Lock Aspect Ratio）。默认锁定，保证调整时不改变图片形状；解锁后可自由拉伸。
    -   **压缩与转换**：
        -   支持 JPG, PNG, WebP 格式导出。
        -   **质量控制**：提供 0-100% 的质量滑块。
        -   **智能预估**：
            -   **精确计算**：单图及批量模式下均使用真实的后端模拟计算（canvas.toBlob），确保预估大小与实际导出大小完全一致（Debounced 500ms 延迟计算）。
            -   实时计算当前所有格式 (JPG, PNG, WebP) 的精确预估大小。
            -   在质量滑块上显示关键点位 (10, 40, 70, 100) 的预估文件大小 (KB/MB)。
    -   **文件名**：导出时自动重命名为 `[原始文件名]_[宽]x[高].[扩展名]`。
    -   **缩放策略**：
        -   **锁定比例**：调整宽度自动计算高度，反之亦然。
        -   **解锁比例**：采用 **"Center Crop" (Cover)** 策略。图像将缩放以覆盖目标尺寸（保持宽高比），并自动裁切掉多余部分（居中裁切），确保图像填满画布且不失真。
4.  **批量处理 (Batch Mode)**：
    -   **批量选择**：左侧栏支持多选图片（Select All / Deselect All）。
    -   **网格预览**：主画布切换为**自适应网格视图** (CSS Grid Auto-fill)，确保每行 Item 宽度一致且充分利用空间。显示精确的文件大小预估。
    -   **统一设置**：右侧栏设置为全局模式，一次性调整所有选中图片的导出格式和质量。
    -   **批量导出**：将所有处理后的图片打包为 ZIP 文件下载。
    -   **交互式预览**：
        -   **对比视图 (Comparison View)**：点击任意图片可进入详细对比模式（左/右 原始 vs 压缩）。
            -   **智能布局**：左侧显示**裁剪后**的图像几何形状，但底部统计信息保留**原始源文件** (Original Source) 数据（尺寸/大小），确保信息准确。
            -   **独立缩放**：左右两侧视图独立计算缩放比例，确保两张图片均完整填充显示区域，消除视觉偏差。
        -   **缩放与平移**：支持鼠标滚轮缩放 (Zoom) 和 拖拽平移 (Pan) 检查细节。
        -   **重置视图**：点击左下角缩放比例指示器可重置为 100%。

## 布局与 UI
应用程序遵循类似于专业编辑工具的三栏布局：
-   **Header (顶部栏)**：品牌标识和全局设置（语言）。
-   **Left Panel (左侧栏)**：
    -   文件上传区域（支持多图上传）。**全屏拖拽高亮**。提示语更新为 "Click to Add"。
    -   **清空操作**：提供“Clear All”按钮（非批量模式下），可一键清空所有图片，并有 Hover 删除图标。
    -   图片库列表（包含批量选择 Checkbox）。
    -   Footer：隐私声明 / 版权信息 / Logo。
-   **Main Canvas (主画布)**：
    -   中央预览区域（单图模式）或 网格视图（批量模式）。
    -   缩放/平移控制（单图）。
    -   **信息展示**：
        -   原始图片信息：尺寸、格式标签。
        -   原始图片信息：尺寸、格式标签。
        -   导出预览信息：实时尺寸、导出格式标签、**体积变化百分比**。
    -   **视觉风格**：
        -   **深灰色主题 (Deep Gray)**：采用 #121212 及 #1e1e1e 作为主色调，提供专注且护眼的编辑环境。
        -   **无边距画布**：图像预览区域最大化，去除不必要的空白边距。
-   **Right Panel (右侧栏)**：
    -   **Crop (裁剪)**：可视化比例网格选择 + 顶部控制栏 (Reset/Cancel/Save)。
    -   **Resize (调整大小)**：宽/高滑块 + 宽高比锁定图标。
    -   **Format (格式)**：格式选择按钮 (JPG/PNG/WebP)，下方显示该格式的预估大小。
    -   **Compression (压缩)**：
        -   质量滑块 (0-100%)。
        -   **刻度显示**：在 10, 40, 70, 100 四个关键点位显示数值及对应的预估文件大小。
        -   紧凑排版设计。
    -   **Storage (存储)**：下载按钮 (单图) / ZIP 下载 (批量)。

## 技术要求
-   **框架**：React (Vite)。
-   **UI 组件库**：Material UI (MUI)。
-   **语言**：TypeScript。
-   **样式**：Emotion / MUI System。
-   **状态管理**：React Context 或 Local State。
-   **部署**：GitHub Pages。

## 国际化
-   支持中文（简体）、英语、日语、韩语等（与 WallpaperPro 保持一致）。
